{"version":3,"sources":["common/components/Pagination/index.jsx","common/hooks/usePdfExport.js","pages/UserManagement/ExportPdfModal.jsx","pages/UserManagement/PdfManagement.jsx","common/hooks/usePdf.js"],"names":["styled","pageCount","initialPage","onPageChange","className","list","previousLabel","previousLinkClassName","nextLabel","nextLinkClassName","breakLabel","breakClassName","marginPagesDisplayed","pageRangeDisplayed","selected","current","scrollIntoView","behavior","block","containerClassName","subContainerClassName","activeClassName","pageLinkClassName","props","theme","colorSecondary","usePdfExport","dispatch","useDispatch","axios","useAxios","useHandleErrors","handleError","toastId","useRef","queryClient","useQueryClient","loading","useSelector","state","export_pdf","shallowEqual","query","useMutation","a","post","config","apiGateWay","timeout","timeoutErrorMessage","data","console","log","mutationKey","onMutate","type","toast","autoClose","onError","err","payload","response","onSuccess","isActive","update","render","target","href","apiResource","link_p","rel","TYPE","SUCCESS","position","POSITION","TOP_RIGHT","success","onSettled","invalidateQueries","isLoading","memo","isOpen","setOpen","Modal","show","contentClassName","data-bs-dismiss","aria-label","onClick","style","borderColor","borderWidth","to","colorTextTitle","useState","page","setPage","pdfData","Axios","useQuery","get","pdfs","usePdf","last_page","modalOpen","setModalOpen","exportPdf","mutate","handleExport","color","size","map","pdf","name_p","datetime","created_at","locale","id_p","Pagination"],"mappings":"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","file":"static/js/15.18b83e09.chunk.js","sourcesContent":["import React from \"react\";\r\nimport ReactPaginate from \"react-paginate\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Pagination = ({ pageCount, initialPage, onPageChange, className, list }) => {\r\n  return (\r\n    <div className={className}>\r\n      <ReactPaginate\r\n        pageCount={pageCount}\r\n        initialPage={initialPage - 1}\r\n        previousLabel={\"Trước\"}\r\n        previousLinkClassName={\"previous button-secondary fw-bold\"}\r\n        nextLabel={\"Sau\"}\r\n        nextLinkClassName={\"next button-secondary fw-bold\"}\r\n        breakLabel={\"...\"}\r\n        breakClassName={\"break-me\"}\r\n        marginPagesDisplayed={2}\r\n        pageRangeDisplayed={5}\r\n        onPageChange={({ selected }) => {\r\n          onPageChange(selected + 1);\r\n          if (list?.current) list.current.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\r\n        }}\r\n        containerClassName={\"pagination\"}\r\n        subContainerClassName={\"pages pagination\"}\r\n        activeClassName={\"active\"}\r\n        // pageClassName={\"button-secondary--outline fw-bold\"}\r\n        pageLinkClassName={\"button-secondary--outline fw-bold\"}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default styled(Pagination)`\r\n  .pagination {\r\n    display: flex;\r\n    justify-content: center;\r\n    padding: 16px;\r\n    margin-top: 16px;\r\n    column-gap: 8px;\r\n    > li {\r\n      > a {\r\n        padding: 10px 20px;\r\n      }\r\n      &.active {\r\n        a {\r\n          background-color: ${(props) => props.theme.colorSecondary};\r\n          color: #fafafa;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .disabled {\r\n    visibility: hidden;\r\n  }\r\n`;\r\n","import { useMutation, useQueryClient } from \"react-query\";\r\nimport useAxios from \"./useAxios\";\r\nimport { config } from \"../../config/api\";\r\nimport useHandleErrors from \"./useHandleErrors\";\r\nimport { toast } from \"react-toastify\";\r\nimport { useRef } from \"react\";\r\nimport { shallowEqual, useDispatch, useSelector } from \"react-redux\";\r\n\r\nconst usePdfExport = () => {\r\n  const dispatch = useDispatch();\r\n  const axios = useAxios();\r\n  const [handleError] = useHandleErrors();\r\n  const toastId = useRef(null);\r\n  const queryClient = useQueryClient();\r\n  const loading = useSelector((state) => !!state?.loading?.export_pdf, shallowEqual);\r\n\r\n  // const isMutatingPosts = useIsMutating(['posts'])\r\n  // const queryClient = useQueryClient();\r\n  const query = useMutation(\r\n    async () => {\r\n      const { data } = await axios.post(`${config.apiGateWay}/dashboard/user/export-pdf`, null, {\r\n        timeout: 100000,\r\n        timeoutErrorMessage: \"Quá lâu\",\r\n      });\r\n      console.log(data);\r\n      return data?.data;\r\n    },\r\n    {\r\n      mutationKey: [\"user\", \"useExportPdf\"],\r\n      onMutate: () => {\r\n        dispatch({ type: \"EXPORT_PDF_REQUEST\" });\r\n        toastId.current = toast(\"File PDF của bạn đang được xuất\", { autoClose: false });\r\n      },\r\n      onError: (err) => {\r\n        dispatch({ type: \"EXPORT_PDF_ERROR\", payload: err?.response?.data });\r\n        handleError(err);\r\n      },\r\n      onSuccess: (data) => {\r\n        if (toast.isActive(toastId.current)) {\r\n          toast.update(toastId.current, {\r\n            render: () => (\r\n              <span>\r\n                Pdf của bạn đã được xuất{\" \"}\r\n                <a target=\"_blank\" href={`${config.apiResource}${data.link_p}`} rel=\"noreferrer\">\r\n                  xem ngay !\r\n                </a>\r\n              </span>\r\n            ),\r\n            type: toast.TYPE.SUCCESS,\r\n            position: toast.POSITION.TOP_RIGHT,\r\n          });\r\n        } else {\r\n          toastId.current = toast.success(\r\n            () => (\r\n              <span>\r\n                Pdf của bạn đã được xuất{\" \"}\r\n                <a target=\"_blank\" href={`${config.apiResource}${data.link_p}`} rel=\"noreferrer\">\r\n                  xem ngay !\r\n                </a>\r\n              </span>\r\n            ),\r\n            {\r\n              autoClose: false,\r\n              position: toast.POSITION.TOP_RIGHT,\r\n            }\r\n          );\r\n        }\r\n        dispatch({ type: \"EXPORT_PDF_SUCCESS\" });\r\n      },\r\n      onSettled: () => {\r\n        queryClient.invalidateQueries([\"user\", \"pdfs\"]);\r\n      },\r\n    }\r\n  );\r\n  return { ...query, isLoading: loading };\r\n};\r\n\r\nexport default usePdfExport;\r\n","import React, { memo } from \"react\";\r\nimport { Modal } from \"react-bootstrap\";\r\nimport { Link } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\n\r\nconst ExportPdfModal = ({ className, isOpen, setOpen }) => {\r\n  return (\r\n    <Modal show={isOpen} className={className} contentClassName=\"modal__custom\">\r\n      <div className=\"modal-header modal__custom__header\">\r\n        <button\r\n          type=\"button\"\r\n          className=\"btn-close modal__custom__button--close\"\r\n          data-bs-dismiss=\"modal\"\r\n          aria-label=\"Close\"\r\n          onClick={() => setOpen?.(false)}\r\n        ></button>\r\n      </div>\r\n      <div className=\"modal-body\">\r\n        <p className=\"fs__title\">Báo cáo của bạn đang được xuất</p>\r\n        {/* <p className=\"fs__title mt-3\">VIETCOMBANK</p>\r\n        <p className=\"d-flex justify-content-between\">\r\n          Số tài khoản: <span>19030001119333</span>\r\n        </p>\r\n        <p className=\"d-flex justify-content-between\">\r\n          Số điện thoại: <span>0123456789</span>\r\n        </p>\r\n        <p className=\"d-flex justify-content-between\">\r\n          Tên đầy đủ: <span>Nguyễn Văn A</span>\r\n        </p>\r\n        <p className=\"d-flex justify-content-between\">\r\n          Số tiền: <span>499.000 VND</span>\r\n        </p> */}\r\n        <p\r\n          className=\"fw-bolder fs__text border-top pt-3\"\r\n          style={{\r\n            borderColor: \"#ffc367 !important\",\r\n            borderWidth: \"2px !important\",\r\n          }}\r\n        >\r\n          Lưu ý:\r\n        </p>\r\n        <p className=\"fs__text\">\r\n          - Số lượt xuất pdf của bạn sẽ bị giảm khi nhấn vào nút \"Xuất pdf\"\r\n        </p>\r\n        <p className=\"fs__text\">\r\n          - Bạn có thể tăng lượt xuất pdf bằng việc nhập mã hoặc{\" \"}\r\n          <Link to=\"/agency-policy\">trở thành đại lý</Link>\r\n        </p>\r\n      </div>\r\n      <div className=\"modal-footer modal__custom__footer\">\r\n        <button\r\n          type=\"button\"\r\n          className=\"btn button-secondary--outline\"\r\n          data-bs-dismiss=\"modal\"\r\n          onClick={() => setOpen?.(false)}\r\n        >\r\n          Đóng\r\n        </button>\r\n        <button type=\"button\" className=\"btn button-secondary\" onClick={() => setOpen?.(false)}>\r\n          Xong\r\n        </button>\r\n      </div>\r\n    </Modal>\r\n    // <div\r\n    //   className={`${className} modal show`}\r\n    //   id=\"staticBackdrop\"\r\n    //   data-bs-backdrop=\"static\"\r\n    //   data-bs-keyboard=\"false\"\r\n    //   tabIndex=\"-1\"\r\n    //   aria-labelledby=\"staticBackdropLabel\"\r\n    //   aria-hidden=\"true\"\r\n    // >\r\n\r\n    // {/* </div> */}\r\n  );\r\n};\r\n\r\nexport default memo(styled(ExportPdfModal)`\r\n  .modal__custom {\r\n    background-color: #fafafa;\r\n    color: black;\r\n    &__header {\r\n      border: none;\r\n    }\r\n    &__footer {\r\n      border: 0;\r\n    }\r\n    &__button--close {\r\n      color: #fafafa !important;\r\n      font-weight: bolder;\r\n      &:hover {\r\n        color: ${(props) => props.theme.colorTextTitle};\r\n      }\r\n    }\r\n  }\r\n`);\r\n","import React, { memo, useRef, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport TimeAgo from \"timeago-react\";\r\n// import { useExportPdf } from \"../../common/hooks/useExportPdf\";\r\nimport { usePdf } from \"../../common/hooks/usePdf\";\r\nimport usePdfExport from \"../../common/hooks/usePdfExport\";\r\nimport { config } from \"../../config/api\";\r\nimport ExportPdfModal from \"./ExportPdfModal\";\r\nimport HashLoader from \"react-spinners/HashLoader\";\r\nimport Pagination from \"../../common/components/Pagination\";\r\n\r\nconst PdfManagement = ({ className }) => {\r\n  console.log(\"rẻender\");\r\n\r\n  const [page, setPage] = useState(1);\r\n  const { data: pdfData } = usePdf({ page });\r\n  const { last_page, data } = pdfData || {};\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n  const list = useRef(null);\r\n\r\n  // const queryClient = useQueryClient()\r\n  const { mutate: exportPdf, isLoading } = usePdfExport();\r\n  const handleExport = async () => {\r\n    if (isLoading) return;\r\n    exportPdf();\r\n    setModalOpen(true);\r\n  };\r\n\r\n  return (\r\n    <section className={`${className} user__management__export col-12 col-lg-9`}>\r\n      <header className=\"fs__title fw-bolder\">Xuất file PDF ERA của bạn</header>\r\n      <p className=\"fs__text my-3\">\r\n        Lorem ipsum dolor sit amet consectetur adipisicing elit. Ipsam facere deserunt illum\r\n        repellat. Quo enim tenetur quaerat. Perspiciatis voluptatum nihil ratione illum cumque\r\n        doloremque et dolor sed expedita? Qui, pariatur? Lorem ipsum dolor sit amet consectetur\r\n        adipisicing elit. Voluptas doloremque beatae possimus, laboriosam eveniet quo nesciunt et\r\n        deleniti facere vero!\r\n      </p>\r\n\r\n      <div className={`button__export button-secondary ${isLoading ? \"disabled\" : \"\"}`}>\r\n        <div onClick={handleExport}>{isLoading ? \"Đang xuất pdf\" : \"Xuất file pdf\"}</div>&nbsp;\r\n        <HashLoader color=\"#fafafa\" size={24} loading={isLoading} />\r\n      </div>\r\n      <header className=\"fs__title fw-bolder mt-4\">Danh sách file pdf của bạn</header>\r\n      <section className=\"pdf__list d-flex flex-column my-4\">\r\n        {data?.map((pdf) => {\r\n          return (\r\n            <div\r\n              key={pdf.id_p}\r\n              className=\"pdf__item d-flex justify-content-between p-3 button-secondary--outline\"\r\n            >\r\n              <a target=\"_blank\" href={`${config.apiResource}${pdf.link_p}`} rel=\"noreferrer\">\r\n                {pdf.name_p}\r\n              </a>\r\n              <TimeAgo datetime={pdf.created_at} locale=\"vi\" />\r\n            </div>\r\n          );\r\n        })}\r\n      </section>\r\n      {pdfData && (\r\n        <Pagination pageCount={last_page} initialPage={page} onPageChange={setPage} list={list} />\r\n      )}\r\n      <ExportPdfModal isOpen={modalOpen} setOpen={setModalOpen} />\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default styled(PdfManagement)`\r\n  &.user__management {\r\n    &__export {\r\n      .pdf {\r\n        &__list {\r\n          row-gap: 12px;\r\n        }\r\n        &__item {\r\n          border-radius: 12px;\r\n          a {\r\n            text-transform: capitalize;\r\n            font-weight: bold;\r\n            color: inherit;\r\n          }\r\n        }\r\n      }\r\n      .button__export {\r\n        display: inline-flex;\r\n        padding: 10px 15px;\r\n        /* background-color: ${(props) => props.theme.colorSecondary}; */\r\n        font-weight: bolder;\r\n        border-radius: 12px;\r\n        div {\r\n          cursor: pointer;\r\n          /* color: #fafafa; */\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n","import { useQuery } from \"react-query\";\r\nimport { config } from \"../../config/api\";\r\nimport useAxios from \"./useAxios\";\r\nimport useHandleErrors from \"./useHandleErrors\";\r\n\r\nexport const usePdf = ({ page = 1 }) => {\r\n  const [handleError] = useHandleErrors();\r\n  const Axios = useAxios();\r\n  const queryInstance = useQuery(\r\n    [\"user\", \"pdfs\", page],\r\n    async () => {\r\n      const { data } = await Axios.get(`${config.apiGateWay}/dashboard/user/pdf?page=${page}`);\r\n      // console.log(data);\r\n      return data.pdfs;\r\n    },\r\n    {\r\n      onError: (err) => {\r\n        handleError(err);\r\n      },\r\n      // onSuccess: (data) => onSuccess(data),\r\n    }\r\n  );\r\n  return queryInstance;\r\n};\r\n"],"sourceRoot":""}