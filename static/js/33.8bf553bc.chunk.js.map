{"version":3,"sources":["common/hooks/useActiveCode.js","pages/GettingReport/Stepper.jsx","common/hooks/useGetNumberResult.js","pages/GettingReport/index.jsx"],"names":["useActiveCode","axios","useAxios","useHandleErrors","handleError","queryClient","useQueryClient","useMutation","code","a","post","config","apiGateWay","data","onError","err","onSuccess","setQueryData","prev","user","styled","className","step","map","title","idx","props","theme","colorTextTitle","useGetNumberResult","formData","rs","onSettled","invalidateQueries","Form1","lazy","Form2","Form3","history","useHistory","numbers","getNumbers","mutateAsync","getNumberLoading","isLoading","activeCode","mutate","activeCodeError","error","activeCodeLoading","useForm","register","handleSubmit","errors","useState","setStep","form","handleMultiform","console","log","push","next","length","onSubmit","fallback","id","getForm","type","onClick","Math","max","style","marginRight","color","size","loading","marginLeft"],"mappings":"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","file":"static/js/33.8bf553bc.chunk.js","sourcesContent":["import { useMutation, useQueryClient } from \"react-query\";\r\nimport useAxios from \"./useAxios\";\r\nimport { config } from \"../../config/api\";\r\nimport useHandleErrors from \"./useHandleErrors\";\r\n\r\nconst useActiveCode = () => {\r\n  const axios = useAxios();\r\n  const [handleError] = useHandleErrors();\r\n  const queryClient = useQueryClient();\r\n  const query = useMutation(\r\n    async (code) => {\r\n      const { data } = await axios.post(\r\n        `${config.apiGateWay}/dashboard/active`,\r\n        { code }\r\n      );\r\n      return data;\r\n    },\r\n    {\r\n      onError: (err) => {\r\n        handleError(err);\r\n      },\r\n      onSuccess: (data) => {\r\n        queryClient.setQueryData([\"user\", \"userInfo\"], (prev) => {\r\n          return { ...prev, ...data?.user };\r\n        });\r\n      },\r\n    }\r\n  );\r\n  return query;\r\n};\r\n\r\nexport default useActiveCode;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Stepper = ({ className, step }) => {\r\n  const stepTitle = [\"Nhập thông tin\", \"Báo cáo\", \"Kích hoạt tài khoản\"];\r\n  return (\r\n    <div className={`${className} step__nav d-flex justify-content-center`}>\r\n      {stepTitle.map((title, idx) => (\r\n        <div key={idx} className={`step ${step === idx ? \"active\" : \"\"}`}>\r\n          <span>{idx + 1}</span> {title}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default styled(Stepper)`\r\n  &.step__nav {\r\n    margin: 40px 0;\r\n    .step {\r\n      margin: 0 20px;\r\n      &:hover {\r\n        cursor: pointer;\r\n      }\r\n      > span {\r\n        place-items: center;\r\n        padding: 4px 10px;\r\n        border-radius: 50%;\r\n        border: 3px solid;\r\n      }\r\n    }\r\n    .active {\r\n      font-weight: bolder;\r\n      color: ${(props) => props.theme.colorTextTitle};\r\n    }\r\n  }\r\n`;\r\n","import { useMutation, useQueryClient } from \"react-query\";\r\nimport useAxios from \"./useAxios\";\r\nimport { config } from \"../../config/api\";\r\nimport useHandleErrors from \"./useHandleErrors\";\r\n\r\nconst useGetNumberResult = () => {\r\n  const axios = useAxios();\r\n  const [handleError] = useHandleErrors();\r\n  const queryClient = useQueryClient();\r\n  const query = useMutation(\r\n    async (formData) => {\r\n      const { data } = await axios.post(`${config.apiGateWay}/dashboard/step-2`, formData);\r\n      return data?.rs;\r\n    },\r\n    {\r\n      onError: (err) => {\r\n        handleError(err);\r\n      },\r\n      onSettled: () => {\r\n        queryClient.invalidateQueries([\"user\", \"userInfo\"]);\r\n      },\r\n    }\r\n  );\r\n  return query;\r\n};\r\n\r\nexport default useGetNumberResult;\r\n","import React, { lazy, Suspense, useState } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport styled from \"styled-components\";\r\nimport useActiveCode from \"../../common/hooks/useActiveCode\";\r\nimport Stepper from \"./Stepper\";\r\nimport HashLoader from \"react-spinners/HashLoader\";\r\nimport { useHistory } from \"react-router\";\r\nimport useGetNumberResult from \"../../common/hooks/useGetNumberResult\";\r\nconst Form1 = lazy(() => import(\"./Form1\"));\r\nconst Form2 = lazy(() => import(\"./Form2\"));\r\nconst Form3 = lazy(() => import(\"./Form3\"));\r\n\r\nconst GettingReport = ({ className }) => {\r\n  const history = useHistory();\r\n  const {\r\n    data: numbers = [],\r\n    mutateAsync: getNumbers,\r\n    isLoading: getNumberLoading,\r\n  } = useGetNumberResult();\r\n  const {\r\n    mutate: activeCode,\r\n    error: activeCodeError,\r\n    isLoading: activeCodeLoading,\r\n  } = useActiveCode();\r\n  const isLoading = getNumberLoading || activeCodeLoading;\r\n  const { register, handleSubmit, errors } = useForm();\r\n  const [step, setStep] = useState(0);\r\n  const form = [\r\n    <Form1 register={register} errors={errors} isLoading={isLoading} />,\r\n    <Form2 numbers={numbers} />,\r\n    <Form3\r\n      register={register}\r\n      errors={errors}\r\n      activeCodeError={activeCodeError}\r\n      isLoading={isLoading}\r\n    />,\r\n  ];\r\n  const getForm = (step) => {\r\n    return form[step];\r\n  };\r\n  const handleMultiform = async (data) => {\r\n    try {\r\n      switch (step) {\r\n        case 0:\r\n          console.log(data);\r\n          await getNumbers(data);\r\n          // console.log(formData);\r\n          break;\r\n        case 2:\r\n          activeCode(data.code, {\r\n            onSuccess: () => {\r\n              history.push(\"/user/pdf\");\r\n            },\r\n          });\r\n          break;\r\n        default:\r\n      }\r\n      next();\r\n    } catch (error) {}\r\n  };\r\n\r\n  const next = () => {\r\n    if (step < form.length - 1) setStep((prev) => ++prev);\r\n  };\r\n  return (\r\n    <section className={`${className} container step_by_step`}>\r\n      <form onSubmit={handleSubmit(handleMultiform)}>\r\n        <main className=\"step__form my-3\">\r\n          <Stepper step={step} />\r\n          <Suspense\r\n            fallback={\r\n              <div id=\"loader-wrapper\">\r\n                <div id=\"loader\"></div>\r\n              </div>\r\n            }\r\n          >\r\n            {getForm(step)}\r\n          </Suspense>\r\n\r\n          <section className=\"step__form__button mt-3\">\r\n            <button\r\n              type=\"button\"\r\n              className={`prev step__from__button button-secondary--outline ${\r\n                step <= 0 ? \"button-disable\" : \"\"\r\n              }`}\r\n              onClick={() => setStep((prev) => Math.max(0, prev - 1))}\r\n            >\r\n              <span style={{ marginRight: 10 }}>\r\n                <i className=\"fas fa-long-arrow-alt-left\"></i>\r\n              </span>\r\n              Trở về\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              className={`next step__from__button button-secondary ${\r\n                isLoading ? \"disabled\" : \"\"\r\n              }`}\r\n              // onClick={step < form.length - 1 ? next : null}\r\n            >\r\n              {isLoading ? (\r\n                <HashLoader color=\"#fafafa\" size={24} loading={true} />\r\n              ) : step === 2 ? (\r\n                \"Hoàn thành\"\r\n              ) : (\r\n                \"Tiếp theo\"\r\n              )}\r\n              {!isLoading && step < 2 && (\r\n                <span style={{ marginLeft: 10 }}>\r\n                  <i className=\"fas fa-long-arrow-alt-right\"></i>\r\n                </span>\r\n              )}\r\n            </button>\r\n          </section>\r\n        </main>\r\n      </form>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default styled(GettingReport)`\r\n  .step__form {\r\n    position: relative;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    &__button {\r\n      -webkit-touch-callout: none; /* iOS Safari */\r\n      -webkit-user-select: none; /* Safari */\r\n      -khtml-user-select: none; /* Konqueror HTML */\r\n      -moz-user-select: none; /* Old versions of Firefox */\r\n      -ms-user-select: none; /* Internet Explorer/Edge */\r\n      user-select: none;\r\n      display: flex;\r\n      justify-content: space-between;\r\n      > button {\r\n        padding: 10px 15px;\r\n        border: 0;\r\n        font-weight: bolder;\r\n        min-width: 126px;\r\n        &.button-disable {\r\n          visibility: hidden;\r\n        }\r\n        /* &:nth-child(1) {\r\n          background-color: rgba(255, 255, 255, 0);\r\n          &:hover {\r\n            background-color: rgba(255, 255, 255, 0.385);\r\n          }\r\n        }\r\n        &:nth-child(2) {\r\n          color: #000;\r\n          &:hover {\r\n            background-color: #ffc267d7;\r\n          }\r\n        } */\r\n      }\r\n    }\r\n  }\r\n`;\r\n"],"sourceRoot":""}