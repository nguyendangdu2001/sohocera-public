{"version":3,"sources":["common/hooks/useAxios.js","common/components/Pagination/index.jsx","common/hooks/useCreateCode.js","pages/AgencyDashBoard/ListCodeTable.jsx","pages/AgencyDashBoard/index.jsx","common/hooks/useAgencyCodes.js"],"names":["useAxios","props","token","useSelector","state","userStatus","userInfo","axios","defaults","headers","Authorization","styled","pageCount","initialPage","onPageChange","className","list","previousLabel","previousLinkClassName","nextLabel","nextLinkClassName","breakLabel","breakClassName","marginPagesDisplayed","pageRangeDisplayed","selected","current","scrollIntoView","behavior","block","containerClassName","subContainerClassName","activeClassName","pageLinkClassName","theme","colorSecondary","useCreateCode","queryClient","useQueryClient","useMutation","a","post","config","apiGateWay","data","code","onSettled","invalidateQueries","ListCodeTable","ref","codes","tempInput","useRef","copyToClipBoard","value","select","document","execCommand","map","id_c","fullname","id","onClick","readOnly","type","window","location","hostname","forwardRef","colorCard","colorTextTitle","useState","setCode","page","setPage","createCode","mutate","Axios","queryInstance","useQuery","get","useAgencyCodes","codesData","none_use","used","last_page","table","name","onSuccess","breakPoints","md"],"mappings":"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","file":"static/js/10.e8047a2d.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nconst useAxios = (props) => {\r\n  const token = useSelector((state) => state.userStatus.userInfo?.token);\r\n  axios.defaults.headers = {\r\n    \"Content-Type\": \"application/json\",\r\n    Authorization: \"Bearer \" + token,\r\n  };\r\n  return axios;\r\n};\r\n\r\nexport default useAxios;\r\n","import React from \"react\";\r\nimport ReactPaginate from \"react-paginate\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Pagination = ({ pageCount, initialPage, onPageChange, className, list }) => {\r\n  return (\r\n    <div className={className}>\r\n      <ReactPaginate\r\n        pageCount={pageCount}\r\n        initialPage={initialPage - 1}\r\n        previousLabel={\"Trước\"}\r\n        previousLinkClassName={\"previous button-secondary fw-bold\"}\r\n        nextLabel={\"Sau\"}\r\n        nextLinkClassName={\"next button-secondary fw-bold\"}\r\n        breakLabel={\"...\"}\r\n        breakClassName={\"break-me\"}\r\n        marginPagesDisplayed={2}\r\n        pageRangeDisplayed={5}\r\n        onPageChange={({ selected }) => {\r\n          onPageChange(selected + 1);\r\n          if (list.current) list.current.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\r\n        }}\r\n        containerClassName={\"pagination\"}\r\n        subContainerClassName={\"pages pagination\"}\r\n        activeClassName={\"active\"}\r\n        // pageClassName={\"button-secondary--outline fw-bold\"}\r\n        pageLinkClassName={\"button-secondary--outline fw-bold\"}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default styled(Pagination)`\r\n  .pagination {\r\n    display: flex;\r\n    justify-content: center;\r\n    padding: 16px;\r\n    margin-top: 16px;\r\n    column-gap: 8px;\r\n    > li {\r\n      > a {\r\n        padding: 10px 20px;\r\n      }\r\n      &.active {\r\n        a {\r\n          background-color: ${(props) => props.theme.colorSecondary};\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .disabled {\r\n    visibility: hidden;\r\n  }\r\n`;\r\n","import { useMutation, useQueryClient } from \"react-query\";\r\nimport useAxios from \"./useAxios\";\r\nimport { config } from \"../../config/api\";\r\n\r\nconst useCreateCode = () => {\r\n  const axios = useAxios();\r\n  const queryClient = useQueryClient();\r\n  const query = useMutation(\r\n    async () => {\r\n      const { data } = await axios.post(`${config.apiGateWay}/dashboard/parter`);\r\n      return data.code;\r\n    },\r\n    {\r\n      // onSuccess: (data) => {\r\n      //   console.log(data);\r\n      //   queryClient.setQueryData([\"agencyCodes\"], (prev) => {\r\n      //     return { ...prev, data: [data, ...prev.data] };\r\n      //   });\r\n      // },\r\n      onSettled: () => {\r\n        queryClient.invalidateQueries([\"agencyCodes\"]);\r\n      },\r\n    }\r\n  );\r\n  return query;\r\n};\r\n\r\nexport default useCreateCode;\r\n","import React, { forwardRef, useRef, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst ListCodeTable = ({ className, codes }, ref) => {\r\n  const tempInput = useRef(null);\r\n\r\n  const copyToClipBoard = (data) => {\r\n    if (!tempInput) return;\r\n    tempInput.current.value = data;\r\n    tempInput.current.select();\r\n    document.execCommand(\"copy\");\r\n  };\r\n  return (\r\n    <main className={`${className} management__table container-fluid`} ref={ref}>\r\n      <div className=\"container overflow-auto\">\r\n        <table>\r\n          <tbody>\r\n            <tr>\r\n              <th>#</th>\r\n              <th>Code</th>\r\n              <th>Họ và tên</th>\r\n              <th>Tình trạng</th>\r\n              <th>Link kích hoạt</th>\r\n            </tr>\r\n\r\n            {codes?.map(({ id_c, code, fullname, id }) => (\r\n              <tr key={id_c}>\r\n                <td>{id_c}</td>\r\n                <td>\r\n                  <button\r\n                    className=\"management__table--icon\"\r\n                    onClick={() => {\r\n                      copyToClipBoard(code);\r\n                    }}\r\n                  >\r\n                    {code}\r\n                    <i className=\"far fa-clipboard\"></i>\r\n                  </button>\r\n                </td>\r\n                <td>{fullname}</td>\r\n                <td>{!id ? \"Chưa sử dụng\" : \"Đã sử dụng\"}</td>\r\n                <td>\r\n                  <input\r\n                    readOnly\r\n                    type=\"text\"\r\n                    value={!id ? `${window.location.hostname}/code/?ref=${code}` : \"\"}\r\n                  />\r\n                  {!id && (\r\n                    <input\r\n                      className=\"management__table--button\"\r\n                      type=\"button\"\r\n                      value=\"Sao chép\"\r\n                      onClick={() => {\r\n                        copyToClipBoard(!id ? `${window.location.hostname}/code/?ref=${code}` : \"\");\r\n                      }}\r\n                    />\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            ))}\r\n            {/* <td>1</td>\r\n              <td>\r\n                <button\r\n                  className=\"management__table--icon\"\r\n                  data-share=\"342T3F\"\r\n                  onClick={() => {\r\n                    copyToClipBoard(\"342T3F\");\r\n                  }}\r\n                >\r\n                  342T3F\r\n                  <i className=\"far fa-clipboard\"></i>\r\n                </button>\r\n              </td>\r\n              <td>Võ Quyết Thắng</td>\r\n              <td>Đã dùng</td> */}\r\n          </tbody>\r\n        </table>\r\n        <input type=\"text\" id=\"temp\" readOnly ref={tempInput} />\r\n      </div>\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default styled(forwardRef(ListCodeTable))`\r\n  padding: 30px 0;\r\n  background-color: ${(props) => props.theme.colorCard};\r\n  th {\r\n    padding: 0 30px 20px 0;\r\n  }\r\n  td {\r\n    /* $py: 20px; */\r\n    padding: 20px 30px 20px 0;\r\n    > input {\r\n      color: #fafafa;\r\n      border: 0;\r\n      outline: none;\r\n      background-color: rgba(255, 255, 255, 0);\r\n    }\r\n    > input[type=\"button\"] {\r\n      color: #fafafa;\r\n      background-color: ${(props) => props.theme.colorCard};\r\n      padding: 10px;\r\n      font-weight: bolder;\r\n      border: 1.5px solid ${(props) => props.theme.colorSecondary};\r\n      &:hover {\r\n        background-color: ${(props) => props.theme.colorSecondary};\r\n        color: #fafafa;\r\n      }\r\n    }\r\n  }\r\n  #temp {\r\n    position: absolute;\r\n    opacity: 0;\r\n  }\r\n  .modal__custom {\r\n    background-color: #2b2b2bfa;\r\n    &__header,\r\n    &__footer {\r\n      border: 0;\r\n    }\r\n    &__button--close {\r\n      color: #fafafa !important;\r\n      font-weight: bolder;\r\n      &:hover {\r\n        color: ${(props) => props.theme.colorTextTitle};\r\n      }\r\n    }\r\n  }\r\n  .management {\r\n    &__table {\r\n      &--icon {\r\n        background-color: rgba(255, 255, 255, 0);\r\n        border: 0;\r\n        color: ${(props) => props.theme.colorTextTitle};\r\n      }\r\n    }\r\n  }\r\n`;\r\n","import React, { useRef, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport Pagination from \"../../common/components/Pagination\";\r\nimport { useAgencyCodes } from \"../../common/hooks/useAgencyCodes\";\r\nimport useCreateCode from \"../../common/hooks/useCreateCode\";\r\nimport ListCodeTable from \"./ListCodeTable\";\r\n\r\nconst AgencyDashBoard = ({ className }) => {\r\n  const [code, setCode] = useState(\"\");\r\n  const [page, setPage] = useState(1);\r\n  const { mutate: createCode } = useCreateCode();\r\n  const [codesData] = useAgencyCodes(page);\r\n  const { none_use, used, data, last_page } = codesData || {};\r\n  const table = useRef(null);\r\n\r\n  return (\r\n    <main className={className}>\r\n      <section className={`container mt-3`}>\r\n        <header className=\"fs__title--main fw-bolder mb-3\">Quản lý báo cáo</header>\r\n        <div className=\"d-flex flex-column flex-md-row\">\r\n          <div className=\"d-flex col-12 col-md-6\">\r\n            <div className=\"management__card w-50\">\r\n              <p className=\"mb-0\">Số dư code</p>\r\n              <p className=\"fs__title--main\">{none_use || 0}</p>\r\n            </div>\r\n            <div className=\"management__card w-50\">\r\n              <p className=\"mb-0\">Số code đã dùng</p>\r\n              <p className=\"fs__title--main\">{used || 0}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"management__form\">\r\n            <p className=\"fs__title\">Tạo mã mới</p>\r\n            <form className=\"d-flex\">\r\n              <input\r\n                className=\"management__form__input\"\r\n                type=\"text\"\r\n                name=\"\"\r\n                id=\"\"\r\n                value={code}\r\n                readOnly\r\n              />\r\n              <input\r\n                className=\"management__form__button\"\r\n                type=\"button\"\r\n                value=\"Tạo mã mới\"\r\n                onClick={() =>\r\n                  createCode(null, {\r\n                    onSuccess: (data) => {\r\n                      setCode(data.code);\r\n                    },\r\n                  })\r\n                }\r\n              />\r\n            </form>\r\n            <p className=\"fs__smallest mt-4\">Chú ý:...</p>\r\n          </div>\r\n        </div>\r\n        <p className=\"fs__title fw-bolder mb-3 mt-5\">Danh sách khách hàng</p>\r\n      </section>\r\n      <ListCodeTable codes={data} ref={table} />\r\n      {codesData && (\r\n        <Pagination pageCount={last_page} initialPage={page} onPageChange={setPage} list={table} />\r\n      )}\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default styled(AgencyDashBoard)`\r\n  .management {\r\n    &__form {\r\n      padding: 10px 0 10px 50px;\r\n      margin-left: 30px;\r\n      border-left: 1px solid ${(props) => props.theme.colorSecondary};\r\n      @media ${(props) => props.theme.breakPoints.md} {\r\n        margin-left: 0;\r\n      }\r\n      &__input {\r\n        color: #fafafa;\r\n        padding: 10px 0;\r\n        text-indent: 10px;\r\n        border: 0;\r\n        background-color: ${(props) => props.theme.colorCard};\r\n        box-shadow: 0 0 0 2px ${(props) => props.theme.colorSecondary};\r\n        &:focus {\r\n          outline: none;\r\n        }\r\n      }\r\n      &__button {\r\n        color: #000;\r\n        background-color: ${(props) => props.theme.colorSecondary};\r\n        padding: 10px;\r\n        border: 0;\r\n        font-weight: bolder;\r\n        &:hover {\r\n          background-color: ${(props) => props.theme.colorSecondary};\r\n          color: #000;\r\n        }\r\n      }\r\n    }\r\n    &__card {\r\n      width: 200px;\r\n      padding: 20px;\r\n      border-radius: 16px;\r\n      background-color: ${(props) => props.theme.colorCard};\r\n      margin: 20px 20px 20px 0;\r\n      p:nth-child(2) {\r\n        font-weight: bolder;\r\n      }\r\n    }\r\n  }\r\n`;\r\n","import { useQuery } from \"react-query\";\r\nimport { config } from \"../../config/api\";\r\nimport useAxios from \"./useAxios\";\r\n\r\nexport const useAgencyCodes = (page = 1) => {\r\n  const Axios = useAxios();\r\n  const queryInstance = useQuery([\"agencyCodes\", page], async () => {\r\n    const { data } = await Axios.get(`${config.apiGateWay}/dashboard/parter?page=${page}`);\r\n    return data.codes;\r\n  });\r\n  return [queryInstance.data, queryInstance];\r\n};\r\n"],"sourceRoot":""}